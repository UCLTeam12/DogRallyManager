@using DogRallyManager.ViewModels.AccountVMs;
@model IEnumerable<DogRallyManager.ViewModels.AccountVMs.UserViewModel>

@{
    ViewData["Title"] = "User List";
}

<h2>@ViewData["Title"]</h2>

<div id="user-list">
    <ul>
        @foreach (var user in Model)
        {
            <li>
                <a href="#" class="user-link" data-username="@user.UserName">@user.UserName</a>
            </li>
        }
    </ul>
</div>

<div id="user-actions">
    <button id="view-profile-btn" disabled>View Profile of User</button>
    <button id="start-chat-btn" disabled>Start chat with <span id="selected-username"></span></button>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var userLinks = document.querySelectorAll('.user-link');
            var viewProfileBtn = document.getElementById('view-profile-btn');
            var startChatBtn = document.getElementById('start-chat-btn');
            var selectedUsernameSpan = document.getElementById('selected-username');
            var selectedUsername = null;

            userLinks.forEach(function(link) {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    selectedUsername = this.getAttribute('data-username');
                    selectedUsernameSpan.textContent = selectedUsername;
                    viewProfileBtn.disabled = false;
                    startChatBtn.disabled = false;
                });
            });

            viewProfileBtn.addEventListener('click', function() {
                if (selectedUsername) {
                    window.location.href = '/User/Profile/' + selectedUsername;
                }
            });

            startChatBtn.addEventListener('click', function() {
                if (selectedUsername) {
                    window.location.href = '/Chat/Start/' + selectedUsername;
                }
            });
        });
    </script>
}